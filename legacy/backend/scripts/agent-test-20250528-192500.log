2025-05-28 19:25:00,763 - INFO - Loading environment from C:\Users\mehdi\code\patchline_v1\.env.local
2025-05-28 19:25:00,774 - INFO - Agent ID: C7VZ0QWDSG
2025-05-28 19:25:00,774 - INFO - Alias ID: WDGFWL1YCB
2025-05-28 19:25:00,812 - INFO - Found credentials in shared credentials file: ~/.aws/credentials
2025-05-28 19:25:01,460 - INFO - 
============================================================
2025-05-28 19:25:01,463 - INFO - TEST 1: LAMBDA FUNCTION
2025-05-28 19:25:01,463 - INFO - ============================================================
2025-05-28 19:25:01,715 - INFO - Function ARN: arn:aws:lambda:us-east-1:366218382497:function:gmail-action-handler
2025-05-28 19:25:01,717 - INFO - Runtime: python3.11
2025-05-28 19:25:01,718 - INFO - Handler: index.lambda_handler
2025-05-28 19:25:01,719 - INFO - Last Modified: 2025-05-28T22:18:16.156+0000
2025-05-28 19:25:01,719 - INFO - 
Environment Variables:
2025-05-28 19:25:01,720 - INFO -   BEDROCK_AGENT_ID: C7VZ0QWDSG
2025-05-28 19:25:01,720 - INFO -   BEDROCK_AGENT_ALIAS_ID: WDGFWL1YCB
2025-05-28 19:25:01,721 - INFO -   GMAIL_SECRETS_NAME: ***REDACTED***
2025-05-28 19:25:01,721 - INFO -   PLATFORM_CONNECTIONS_TABLE: PlatformConnections-staging
2025-05-28 19:25:01,722 - INFO -   KNOWLEDGE_BASE_BUCKET: patchline-email-knowledge-base
2025-05-28 19:25:01,759 - INFO - 
Resource Policy Statements:
2025-05-28 19:25:01,764 - INFO -   - AllowBedrockInvoke: {'Service': 'bedrock.amazonaws.com'}
2025-05-28 19:25:03,745 - INFO - Response Status: 200
2025-05-28 19:25:03,746 - INFO - Response: {
  "messageVersion": "1.0",
  "response": {
    "actionGroup": "GmailActions",
    "apiPath": "/searchEmails",
    "httpMethod": "POST",
    "httpStatusCode": 404,
    "responseBody": {
      "application/json": {
        "body": "{\"error\": \"Action not found\"}"
      }
    }
  }
}
2025-05-28 19:25:03,754 - INFO - 
============================================================
2025-05-28 19:25:03,754 - INFO - TEST 2: AGENT CONFIGURATION
2025-05-28 19:25:03,755 - INFO - ============================================================
2025-05-28 19:25:04,228 - INFO - Agent Name: PatchlineEmailAgent
2025-05-28 19:25:04,231 - INFO - Status: PREPARED
2025-05-28 19:25:04,231 - INFO - Model: us.anthropic.claude-sonnet-4-20250514-v1:0
2025-05-28 19:25:04,232 - INFO - Updated: 2025-05-28 22:12:30.867529+00:00
2025-05-28 19:25:04,424 - INFO - 
Action Groups:
2025-05-28 19:25:04,425 - INFO -   - GmailActions (ENABLED)
2025-05-28 19:25:04,500 - INFO - 
Alias Name: Production
2025-05-28 19:25:04,501 - INFO - Alias Status: PREPARED
2025-05-28 19:25:04,502 - INFO - Alias Version: Unknown
2025-05-28 19:25:04,508 - INFO - 
============================================================
2025-05-28 19:25:04,508 - INFO - TEST 3: AGENT INVOCATION
2025-05-28 19:25:04,508 - INFO - ============================================================
2025-05-28 19:25:04,515 - INFO - Query: Hello, can you help me with emails?
2025-05-28 19:25:12,758 - INFO - Chunk: Hello! I'm Patchy, your AI assistant for managing music industry communications. I'd be happy to help you with your emails!

I can assist you with:
- **Searching and reading emails** - Find specific messages, conversations, or topics
- **Creating email drafts** - Help you compose professional emails
- **Sending emails** - Send messages (with your approval)
- **Email analysis** - Summarize content, highlight important dates and action items
- **Managing communications** - Keep track of contracts, bookings, collaborations, and other music business correspondence

What would you like to do with your emails today? For example, you could ask me to:
- Search for emails from a specific person or about a particular topic
- Check your recent unread messages
- Help draft a response to someone
- Get an overview of your email activity

Just let me know what you need help with!
2025-05-28 19:25:12,779 - INFO - Query: Search for emails from last week
2025-05-28 19:25:32,874 - INFO - Chunk: I found 9 emails from the last week (past 7 days). Here's a summary of your recent emails:

**Most Recent (May 28, 2025):**
- **Google Workspace Trial** - from Google Workspace Team regarding exploring your trial for patchline.ai

**May 27, 2025:**
- **"Can we sign the contract?"** - from Mehdi Noori asking about signing a 50/50 deal, marked as ASAP
- **Test Draft** - from mehdi@patchline.ai (appears to be a system test)
- **Spotify for Artists Welcome** - Welcome message from Spotify for Artists

**May 26, 2025:**
- **Google Workspace Recommendations** - Tools to keep you in the flow
- **Spotify for Artists Access Request** - from Artist Support requesting more info about Patchline Records metadata

**May 25, 2025:**
- **Spotify Confirmation Code** - Email confirmation code (989378) for Spotify for Artists

**May 24, 2025:**
- **Google Workspace AI Recommendations** - About saving time with AI features

**May 22, 2025:**
- **Google Workspace Team Sync** - Recommendations for staying in sync with your team

**Key Action Item:** You have an urgent email from Mehdi Noori about signing a contract with a 50/50 deal. This seems to require immediate attention based on the "ASAP" note.

Would you like me to read any of these emails in detail or help you respond to the contract inquiry?
2025-05-28 19:25:32,897 - INFO - Query: Show me recent important emails
2025-05-28 19:26:17,866 - INFO - Chunk: Sorry, I am unable to assist you with this request.
2025-05-28 19:26:17,878 - INFO - 
============================================================
2025-05-28 19:26:17,878 - INFO - TEST SUMMARY
2025-05-28 19:26:17,878 - INFO - ============================================================
